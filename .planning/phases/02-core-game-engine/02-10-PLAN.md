---
phase: 02-core-game-engine
plan: 10
type: execute
wave: 5
depends_on: ["02-06", "02-07", "02-08", "02-09"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User can create a game room from lobby"
    - "Other users can see and join the room"
    - "Players can ready up and start the game"
    - "Dice rolling, scoresheet selection, and turn flow work correctly"
    - "Chat messages appear in real-time"
    - "Game completes with winner determination"
  artifacts: []
  key_links: []
---

<objective>
Full end-to-end verification of the Kniffel game experience.

Purpose: Before closing Phase 2, verify that all components work together: lobby -> create room -> join -> ready up -> play full game -> results -> rematch. This is a human checkpoint because it requires visual verification of 3D dice, interactive gameplay, and the Stammtisch feel.
Output: Verified game experience or list of issues to fix.
</objective>

<execution_context>
@C:\Users\maxi\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\maxi\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete Kniffel game: lobby, room creation, waiting room, 3D dice, scoresheet, turn timers, chat, spectator mode, AFK handling, rematch voting</what-built>
  <how-to-verify>
Prerequisites: PostgreSQL running, app started with `npm run dev`

1. **Lobby (open two browser windows, logged in as different users)**
   - Window 1: Lobby shows "Keine offenen Raeume" empty state
   - Click "Raum erstellen", fill in room name, settings
   - Room appears in lobby list

2. **Join Room**
   - Window 2: Room card appears in real-time (no page refresh)
   - Click "Beitreten" on the room card
   - Both windows redirect to /game/[roomId]

3. **Waiting Room**
   - Both players see each other in player list
   - Toggle "Bereit" buttons
   - Host sees "Spiel starten" button (enabled when all ready)

4. **Gameplay**
   - Host clicks "Spiel starten"
   - 3D dice appear on green felt table
   - Current player can click "Wuerfeln" -- dice tumble with physics
   - Click dice to keep/release them (visual distinction)
   - After rolling, scoresheet highlights available categories with potential scores
   - Click category to score -- score fills in, turn advances
   - Turn timer counts down correctly
   - Other player sees all updates in real-time

5. **Chat**
   - Expand chat drawer at bottom
   - Send messages -- appear for both players
   - System messages show (e.g., "hat gewuerfelt", "hat Kniffel gewaehlt")

6. **Turn Timer + Auto-play**
   - Let timer run out -- auto-play selects a category
   - System message confirms auto-play

7. **Game End**
   - Play through multiple rounds (or test with shortened game)
   - Game results screen shows with rankings
   - "Noch eine Runde?" voting appears

8. **Visual Quality**
   - 3D dice look good (faces show correct numbers)
   - Scoresheet is readable on desktop and mobile
   - Dark theme with green accent consistent throughout
   - All text in German

Verify these Phase 2 success criteria:
- [ ] User can create game room specifying Kniffel as game type
- [ ] Other users can see and join open Kniffel rooms from lobby
- [ ] Players at table can take turns rolling dice and filling scoresheet
- [ ] All players see identical game state in real-time
- [ ] Game enforces turn timers and auto-plays if player goes inactive
- [ ] Players can send text messages to others at their table
- [ ] Inactive players are automatically removed from room after timeout
- [ ] Empty rooms are cleaned up automatically
  </how-to-verify>
  <resume-signal>Type "approved" if all checks pass, or describe specific issues that need fixing</resume-signal>
</task>

</tasks>

<verification>
All 8 Phase 2 success criteria verified by human testing.
</verification>

<success_criteria>
Human confirms all Phase 2 success criteria pass.
</success_criteria>

<output>
After completion, create `.planning/phases/02-core-game-engine/02-10-SUMMARY.md`
</output>

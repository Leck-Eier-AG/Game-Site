---
phase: 03-virtual-currency-betting
plan: 10
type: execute
wave: 5
depends_on: ["03-07", "03-08", "03-09"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "New user receives starting balance from SystemSettings"
    - "Balance visible on every page in sidebar"
    - "Room creator can create free or bet rooms"
    - "Bet room buy-in deducted, refunded, or forfeited correctly"
    - "Game end pays out winners per payout ratios"
    - "Admin can manage economy from finance page"
    - "All balance changes logged as transactions"
---

<objective>
Full verification checkpoint for Phase 3: Virtual Currency and Betting.

Purpose: Verify all Phase 3 success criteria are met through end-to-end testing of the complete virtual currency system. This covers wallet creation, daily claims, transfers, betting lifecycle, admin controls, and economic configuration.

Output: Verification results confirming all GUTH requirements are satisfied.
</objective>

<execution_context>
@/home/maxi/.claude/get-shit-done/workflows/execute-plan.md
@/home/maxi/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Full Phase 3 verification checkpoint</name>
  <files></files>
  <action>
Present the following verification checklist to the user and await their confirmation.

Complete virtual currency and betting system to verify:
- Wallet system with automatic creation and starting balance
- Sidebar balance widget with animated counter and popover
- Wallet page with balance chart, transaction history, daily claim, P2P transfers
- Free/bet room toggle in room creation with preset amounts and custom input
- Lobby filter tabs (All/Free/Bet) with chip badges on bet rooms
- Escrow lifecycle: buy-in on join, refund before start, forfeit mid-game, payout on game end
- Bet confirmation dialog for high-stakes bets (>25% of balance)
- Pot display on game board during gameplay
- Payout breakdown on results screen
- Admin finance page: economy dashboard, transaction log, balance tools, system settings, alerts
- Admin wallet freeze/unfreeze
- Activity-scaled daily allowance with weekly bonus

Test scenarios (start dev server with `npm run dev`):

1. Wallet Creation (GUTH-01): Register new user, verify starting balance in sidebar and /wallet
2. Balance Visibility (GUTH-02): Navigate pages, verify widget on every page, hover popover works
3. Daily Allowance: Claim on /wallet, verify animation, verify disabled after claim
4. P2P Transfer: Send chips, verify both balances update, both see transactions
5. Room Creation (GUTH-05): Create free room (Kostenlos badge), create bet room (chip badge), filter tabs
6. Bet Lifecycle: Join bet room (deducted), leave before start (refunded), play to end (payout)
7. High-Stakes (GUTH-06): Bet >25% of balance, verify confirmation dialog
8. Insufficient Balance: Low-balance user joins expensive room as spectator
9. Admin Finance (GUTH-03/04): Dashboard, adjust balance, verify in transaction log
10. System Settings: Change currency name, verify updates; change starting balance, test new user
11. Wallet Freeze: Freeze user, verify transfer blocked but free play works, unfreeze
  </action>
  <verify>User confirms all 11 scenarios pass or reports specific issues.</verify>
  <done>All GUTH-01 through GUTH-06 requirements verified. Full betting lifecycle works end-to-end. Admin has complete economic control. All balance changes tracked with descriptive German text.</done>
</task>

</tasks>

<verification>
Phase 3 success criteria:
1. New user receives starting balance (from SystemSettings, admin configurable)
2. User sees current balance on every page
3. Room creator can set optional bet amount
4. System validates sufficient balance before bet
5. High-stakes bets show confirmation dialog
6. Admin can add or remove balance
7. All balance changes logged in transaction history
</verification>

<success_criteria>
All GUTH-01 through GUTH-06 requirements verified. Full betting lifecycle works end-to-end. Admin has complete economic control. All balance changes tracked.
</success_criteria>

<output>
After completion, create `.planning/phases/03-virtual-currency-betting/03-10-SUMMARY.md`
</output>
